{% comment %}
  /snippets/video-json-ld.liquid
  
  Generates VideoObject JSON-LD structured data for a single video
  
  Parameters:
  - video_url: Video URL (required)
  - video_name: Video name/title (optional)
  - video_description: Video description (optional)
  - thumbnail_url: Thumbnail image URL (optional)
  - duration: Video duration in seconds (optional)
  - page_url: Current page URL (optional - defaults to canonical_url)
  
  Usage:
  {% render 'video-json-ld', 
    video_url: block.settings.video_bg.url,
    video_name: block.settings.title,
    video_description: block.settings.richtext,
    thumbnail_url: block.settings.video_bg.preview_image,
    duration: block.settings.video_bg.duration
  %}
{% endcomment %}

{%- if video_url != blank -%}
{%- liquid
  assign page_url = page_url | default: canonical_url
  assign current_date = 'now' | date: '%Y-%m-%dT%H:%M:%S%z'
  assign video_title = video_name | default: page.title | strip_html | escape
  assign video_desc = video_description | strip_html | truncate: 160 | escape
-%}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "VideoObject",
  "name": "{{ video_title }}",
  {% if video_desc != blank %}"description": "{{ video_desc }}",{% endif %}
  "url": "{{ page_url }}",
  "contentUrl": "{{ video_url }}",
  {% if thumbnail_url %}"thumbnailUrl": "{{ thumbnail_url | image_url: width: 1200 }}",{% endif %}
  {% if duration %}"duration": "PT{{ duration }}S",{% endif %}
  "datePublished": "{{ current_date }}",
  "uploadDate": "{{ current_date }}",
  "publisher": {
    "@type": "Organization",
    "name": "{{ shop.name }}"
  }
}
</script>
{%- endif -%} 