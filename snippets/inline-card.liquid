{% comment %}
  Inline Card Snippet
    
  Usage:
  {% render 'inline-card',
    card_image: card_image,
    card_video_file: card_video_file,
    card_video_url: card_video_url,
    card_title: card_title,
    card_description: card_description,
    card_title_size: card_title_size,
    card_description_size: card_description_size,
    text_overlay: text_overlay,
    title_color: title_color,
    description_color: description_color
  %}
{% endcomment %}

<div class="inline-card-container {% if text_overlay %}inline-card-container--overlay{% endif %}">
  
  <!-- Card Media (Video or Image) -->
  <div class="card-media-wrapper">
    {% if card_video_file != blank %}
      {% comment %} Native Shopify Video {% endcomment %}
      <div class="card-video">
        {{ card_video_file | video_tag: 
          controls: true, 
          autoplay: false, 
          loop: false, 
          muted: false,
          playsinline: true,
          preload: 'metadata',
          class: 'card-video__native'
        }}
      </div>
    {% elsif card_video_url != blank %}
      {% comment %} External Video (YouTube/Vimeo) {% endcomment %}
      <div class="card-video">
        {% if card_video_url contains 'youtube' or card_video_url contains 'youtu.be' %}
          {% assign video_id = card_video_url | split: 'v=' | last | split: '&' | first %}
          {% if card_video_url contains 'youtu.be' %}
            {% assign video_id = card_video_url | split: '.be/' | last | split: '?' | first %}
          {% endif %}
          <iframe 
            src="https://www.youtube.com/embed/{{ video_id }}?rel=0"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen
            class="card-video__iframe">
          </iframe>
        {% elsif card_video_url contains 'vimeo' %}
          {% assign video_id = card_video_url | split: 'vimeo.com/' | last | split: '?' | first %}
          <iframe 
            src="https://player.vimeo.com/video/{{ video_id }}"
            frameborder="0"
            allow="autoplay; fullscreen; picture-in-picture"
            allowfullscreen
            class="card-video__iframe">
          </iframe>
        {% endif %}
      </div>
    {% elsif card_image != blank %}
      {% comment %} Card Image {% endcomment %}
      {%- capture image_sizes -%}
        (min-width: 1100px) calc((100vw - 6rem) / 3), 
        (min-width: 750px) calc((100vw - 4rem) / 2), 
        (max-width: 749px) calc(100vw - 4rem)
      {%- endcapture -%}
      
      {% render 'image',
        img_object: card_image,
        alt: card_title,
        class: 'card-image',
        sizes: image_sizes,
        loading: 'lazy',
        wh_ratio: 1.18
      %}
    {% else %}
      {% comment %} Placeholder {% endcomment %}
      <div class="card-media-placeholder" style="aspect-ratio: 1.18;">
        {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
      </div>
    {% endif %}
  </div>
  
  <!-- Card Content -->
  <div class="card-content" {% if text_overlay %}style="--title-color: {{ title_color }}; --description-color: {{ description_color }};"{% endif %}>
    {% if card_title != blank %}
      <h3 class="card-title heading-size-{{ card_title_size }}"{% if text_overlay and title_color != blank %} style="color: {{ title_color }};"{% endif %}>
        {{ card_title }}
      </h3>
    {% endif %}
    
    {% if card_description != blank %}
      <div class="card-description rte body-size-{{ card_description_size }}"{% if text_overlay and description_color != blank %} style="color: {{ description_color }};"{% endif %}>
        {{ card_description }}
      </div>
    {% endif %}
  </div>
  
</div> 