<div class="multistep-step multistep-step--1" data-step="1" style="display: block;">
  <div class="step1-container">
      <div class="step1-info">
        <h1 class="product-title">{{ product.title }}</h1>

        {%- if product.metafields.theme.cutline.value -%}
          <p class="product-cutline">{{ product.metafields.theme.cutline.value }}</p>
        {%- endif -%}

        {%- liquid
          assign lowest_variant = null
          assign lowest_price = null
          assign lowest_compare_at_price = null
          
          for variant in product.variants
            if variant.available
              if lowest_variant == null or variant.price < lowest_price
                assign lowest_variant = variant
                assign lowest_price = variant.price
                assign lowest_compare_at_price = variant.compare_at_price
              endif
            endif
          endfor
        -%}

        <div class="product-price">
          <span class="price" data-product-price>
            {%- if lowest_variant != null -%}
              {%- if lowest_compare_at_price != null and lowest_compare_at_price > lowest_price -%}
                Start at {{ lowest_price | money }} <span style="text-decoration: line-through;">{{ lowest_compare_at_price | money }}</span>
              {%- else -%}
                {{ lowest_price | money }}
              {%- endif -%}
            {%- else -%}
              {{ current_variant.price | money }}
            {%- endif -%}
          </span>
        </div>
      </div>
    <div class="step1-product-container">
      {% assign plus_icon_url = 'https://cdn.shopify.com/s/files/1/0552/2135/4567/files/Plus2.png?v=1766061549' %}
      <div class="step1-images">
          <div class="product-main-image">
            <img src="https://cdn.shopify.com/s/files/1/0552/2135/4567/files/advanced.png?v=1763194702"
                alt="{{ product.title }}"
                class="product-image desktop--only">
            <img src="https://cdn.shopify.com/s/files/1/0552/2135/4567/files/Frame_671239393.png?v=1765103741"
            alt="{{ product.title }}"
            class="product-image mobile--only">
                <button type="button" class="plus-icon-1 plus-absolute" data-feature-modal="1">
                  <img src="{{ plus_icon_url }}" alt="read more about the feature" width="46" height="46">
                </button>
                <button type="button" class="plus-icon-2 plus-absolute" data-feature-modal="2">
                  <img src="{{ plus_icon_url }}" alt="read more about the feature" width="46" height="46">
                </button>
                <button type="button" class="plus-icon-3 plus-absolute" data-feature-modal="3">
                  <img src="{{ plus_icon_url }}" alt="read more about the feature" width="46" height="46">
                </button>
                <button type="button" class="plus-icon-4 plus-absolute" data-feature-modal="4">
                  <img src="{{ plus_icon_url }}" alt="read more about the feature" width="46" height="46">
                </button>
                <button type="button" class="plus-icon-5 plus-absolute" data-feature-modal="5">
                  <img src="{{ plus_icon_url }}" alt="read more about the feature" width="46" height="46">
                </button>
                <button type="button" class="plus-icon-6 plus-absolute" data-feature-modal="6">
                  <img src="{{ plus_icon_url }}" alt="read more about the feature" width="46" height="46">
                </button>
          </div>
      </div>
      <div class="step1-features-container">
      {%- assign product_features = shop.metaobjects.multistep_product_features.values -%}
      {%- assign feature_order = 'd-3-o-jolt-free,side-impact-protection,anti-rebound-bar,support-leg,energy-absorption-coils,rigid-latch' | split: ',' -%}

        <div class="product-features">
          {%- for handle in feature_order -%}
            {%- for feature in product_features -%}
              {%- if feature.system.handle == handle -%}
                <button type="button" class="product-feature-item" data-feature-modal="{{ forloop.parentloop.index }}">
                  {%- if feature.image != blank -%}
                    <img src="{{ feature.image | image_url: width: 120 }}" alt="{{ feature.title }}" class="feature-icon">
                  {%- endif -%}
                  <div class="feature-title">{{ feature.title }}</div>
                </button>
                {%- break -%}
              {%- endif -%}
            {%- endfor -%}
          {%- endfor -%}
        </div>

      <button type="button" class="btn btn--steps btn--large btn--step-1" data-customize-btn>
        Customize
      </button>
      </div>
    </div>
  </div>
</div>

<div class="feature-modal-backdrop" data-feature-backdrop style="display: none;">
  <div class="feature-modal-content">
    <div class="feature-modal-body" data-feature-modal-body></div>
    <button type="button" class="btn btn--white btn--large feature-modal-customize" data-feature-customize>
      Customize
    </button>
  </div>
</div>

{%- for handle in feature_order -%}
  {%- for feature in product_features -%}
    {%- if feature.system.handle == handle -%}
      <script type="application/json" data-feature-data="{{ forloop.parentloop.index }}">
        {
          "title": {{ feature.title | default: '' | json }},
          "description": {{ feature.description.value | default: feature.description | default: '' | json }},
          "image": {% if feature.image != blank %}{{ feature.image | image_url: width: 400 | json }}{% else %}null{% endif %}
        }
      </script>
      {%- break -%}
    {%- endif -%}
  {%- endfor -%}
{%- endfor -%}
